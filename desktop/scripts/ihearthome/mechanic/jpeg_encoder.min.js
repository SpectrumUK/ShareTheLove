function JPEGEncoder(e){function P(e){var t=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99];for(var n=0;n<64;n++){var a=r((t[n]*e+50)/100);if(a<1){a=1}else if(a>255){a=255}i[N[n]]=a}var f=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99];for(var l=0;l<64;l++){var c=r((f[l]*e+50)/100);if(c<1){c=1}else if(c>255){c=255}s[N[l]]=c}var h=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379];var p=0;for(var d=0;d<8;d++){for(var v=0;v<8;v++){o[p]=1/(i[N[p]]*h[d]*h[v]*8);u[p]=1/(s[N[p]]*h[d]*h[v]*8);p++}}}function H(e,t){var n=0;var r=0;var i=new Array;for(var s=1;s<=16;s++){for(var o=1;o<=e[s];o++){i[t[r]]=[];i[t[r]][0]=n;i[t[r]][1]=s;r++;n++}n*=2}return i}function B(){a=H(C,k);f=H(O,M);l=H(L,A);c=H(_,D)}function j(){var e=1;var t=2;for(var n=1;n<=15;n++){for(var r=e;r<t;r++){p[32767+r]=n;h[32767+r]=[];h[32767+r][1]=n;h[32767+r][0]=r}for(var i=-(t-1);i<=-e;i++){p[32767+i]=n;h[32767+i]=[];h[32767+i][1]=n;h[32767+i][0]=t-1+i}e<<=1;t<<=1}}function F(){for(var e=0;e<256;e++){x[e]=19595*e;x[e+256>>0]=38470*e;x[e+512>>0]=7471*e+32768;x[e+768>>0]=-11059*e;x[e+1024>>0]=-21709*e;x[e+1280>>0]=32768*e+8421375;x[e+1536>>0]=-27439*e;x[e+1792>>0]=-5329*e}}function I(e){var t=e[0];var n=e[1]-1;while(n>=0){if(t&1<<n){g|=1<<y}n--;y--;if(y<0){if(g==255){q(255);q(0)}else{q(g)}y=7;g=0}}}function q(e){m.push(S[e])}function R(e){q(e>>8&255);q(e&255)}function U(e,t){var n,r,i,s,o,u,a,f;var l=0;var c;var h=8;var p=64;for(c=0;c<h;++c){n=e[l];r=e[l+1];i=e[l+2];s=e[l+3];o=e[l+4];u=e[l+5];a=e[l+6];f=e[l+7];var v=n+f;var m=n-f;var g=r+a;var y=r-a;var b=i+u;var w=i-u;var E=s+o;var S=s-o;var x=v+E;var T=v-E;var N=g+b;var C=g-b;e[l]=x+N;e[l+4]=x-N;var k=(C+T)*.707106781;e[l+2]=T+k;e[l+6]=T-k;x=S+w;N=w+y;C=y+m;var L=(x-C)*.382683433;var A=.5411961*x+L;var O=1.306562965*C+L;var M=N*.707106781;var _=m+M;var D=m-M;e[l+5]=D+A;e[l+3]=D-A;e[l+1]=_+O;e[l+7]=_-O;l+=8}l=0;for(c=0;c<h;++c){n=e[l];r=e[l+8];i=e[l+16];s=e[l+24];o=e[l+32];u=e[l+40];a=e[l+48];f=e[l+56];var P=n+f;var H=n-f;var B=r+a;var j=r-a;var F=i+u;var I=i-u;var q=s+o;var R=s-o;var U=P+q;var z=P-q;var W=B+F;var X=B-F;e[l]=U+W;e[l+32]=U-W;var V=(X+z)*.707106781;e[l+16]=z+V;e[l+48]=z-V;U=R+I;W=I+j;X=j+H;var $=(U-X)*.382683433;var J=.5411961*U+$;var K=1.306562965*X+$;var Q=W*.707106781;var G=H+Q;var Y=H-Q;e[l+40]=Y+J;e[l+24]=Y-J;e[l+8]=G+K;e[l+56]=G-K;l++}var Z;for(c=0;c<p;++c){Z=e[c]*t[c];d[c]=Z>0?Z+.5|0:Z-.5|0}return d}function z(){R(65504);R(16);q(74);q(70);q(73);q(70);q(0);q(1);q(1);q(0);R(1);R(1);q(0);q(0)}function W(e,t){R(65472);R(17);q(8);R(t);R(e);q(3);q(1);q(17);q(0);q(2);q(17);q(1);q(3);q(17);q(1)}function X(){R(65499);R(132);q(0);for(var e=0;e<64;e++){q(i[e])}q(1);for(var t=0;t<64;t++){q(s[t])}}function V(){R(65476);R(418);q(0);for(var e=0;e<16;e++){q(C[e+1])}for(var t=0;t<=11;t++){q(k[t])}q(16);for(var n=0;n<16;n++){q(L[n+1])}for(var r=0;r<=161;r++){q(A[r])}q(1);for(var i=0;i<16;i++){q(O[i+1])}for(var s=0;s<=11;s++){q(M[s])}q(17);for(var o=0;o<16;o++){q(_[o+1])}for(var u=0;u<=161;u++){q(D[u])}}function $(){R(65498);R(12);q(3);q(1);q(0);q(2);q(17);q(3);q(17);q(0);q(63);q(0)}function J(e,t,n,r,i){var s=i[0];var o=i[240];var u;var a=16;var f=63;var l=64;var c=U(e,t);for(var d=0;d<l;++d){v[N[d]]=c[d]}var m=v[0]-n;n=v[0];if(m==0){I(r[0])}else{u=32767+m;I(r[p[u]]);I(h[u])}var g=63;for(;g>0&&v[g]==0;g--){}if(g==0){I(s);return n}var y=1;var b;while(y<=g){var w=y;for(;v[y]==0&&y<=g;++y){}var E=y-w;if(E>=a){b=E>>4;for(var S=1;S<=b;++S)I(o);E=E&15}u=32767+v[y];I(i[(E<<4)+p[u]]);I(h[u]);y++}if(g!=f){I(s)}return n}function K(){var e=String.fromCharCode;for(var t=0;t<256;t++){S[t]=e(t)}}function Q(e){if(e<=0){e=1}if(e>100){e=100}if(T==e)return;var t=0;if(e<50){t=Math.floor(5e3/e)}else{t=Math.floor(200-e*2)}P(t);T=e}function G(){var t=(new Date).getTime();if(!e)e=50;K();B();j();F();Q(e);var n=(new Date).getTime()-t}var t=this;var n=Math.round;var r=Math.floor;var i=new Array(64);var s=new Array(64);var o=new Array(64);var u=new Array(64);var a;var f;var l;var c;var h=new Array(65535);var p=new Array(65535);var d=new Array(64);var v=new Array(64);var m=[];var g=0;var y=7;var b=new Array(64);var w=new Array(64);var E=new Array(64);var S=new Array(256);var x=new Array(2048);var T;var N=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63];var C=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0];var k=[0,1,2,3,4,5,6,7,8,9,10,11];var L=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125];var A=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250];var O=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0];var M=[0,1,2,3,4,5,6,7,8,9,10,11];var _=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119];var D=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];this.encode=function(e,t){var n=(new Date).getTime();if(t)Q(t);m=new Array;g=0;y=7;R(65496);z();X();W(e.width,e.height);V();$();var r=0;var i=0;var s=0;g=0;y=7;this.encode.displayName="_encode_";var h=e.data;var p=e.width;var d=e.height;var v=p*4;var S=p*3;var T,N=0;var C,k,L;var A,O,M,_,D;while(N<d){T=0;while(T<v){A=v*N+T;O=A;M=-1;_=0;for(D=0;D<64;D++){_=D>>3;M=(D&7)*4;O=A+_*v+M;if(N+_>=d){O-=v*(N+1+_-d)}if(T+M>=v){O-=T+M-v+4}C=h[O++];k=h[O++];L=h[O++];b[D]=(x[C]+x[k+256>>0]+x[L+512>>0]>>16)-128;w[D]=(x[C+768>>0]+x[k+1024>>0]+x[L+1280>>0]>>16)-128;E[D]=(x[C+1280>>0]+x[k+1536>>0]+x[L+1792>>0]>>16)-128}r=J(b,o,r,a,l);i=J(w,u,i,f,c);s=J(E,u,s,f,c);T+=32}N+=8}if(y>=0){var P=[];P[1]=y+1;P[0]=(1<<y+1)-1;I(P)}R(65497);var H="data:image/jpeg;base64,"+btoa(m.join(""));m=[];var B=(new Date).getTime()-n;return H};G()}